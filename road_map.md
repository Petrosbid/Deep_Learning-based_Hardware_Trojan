### مرحله ۱: استخراج اطلاعات از بلوک‌های نت‌لیست (Steps 1-4)
1.  **ورودی:** فایل نت‌لیست سطح گیت (Gate-Level Netlist). (توجه: این فایل، *خروجی* نرم‌افزار سنتز VHDL است، نه خودِ کد VHDL).
2. **ایجاد گراف:** ابتدا نت‌لیست را به یک گراف پین-به-پین (Pin-level Graph) تبدیل می‌کند که در آن هر گیت، هر پین ورودی و هر پین خروجی یک گره در گراف است.
3.  **ایجاد بلوک:** به ازای **تک‌تک گیت‌های** موجود در طراحی، یک «بلوک نت‌لیست» (Netlist Block) می‌سازد.این بلوک شامل خودِ گیت (به عنوان گیت مرکزی) و تمام گیت‌های همسایه آن تا عمق مشخصی (مثلاً ۴ سطح منطقی) است.
4. **استخراج مسیر (Trace):** از داخل هر بلوک، تمام مسیرهای سیگنالی که از گیت مرکزی عبور می‌کنند را استخراج می‌کند.به هر مسیر یک «ردیابی ویژگی Pin-Cell-Pin» یا **PCP Trace** گفته می‌شود.

### مرحله ۲: کدگذاری نت‌لیست با NLP (روش Net2Vec) (Step 5)
این هوشمندانه‌ترین بخش مقاله است.
1. **نت‌لیست به مثابه زبان:** سیستم با نت‌لیست مانند یک «زبان» رفتار می‌کند.
2. **«کلمه» (Word):** هر اتصال پایه‌ای سه‌تایی (پین ورودی، خود گیت، پین خروجی) به عنوان یک «کلمه» (Word) در نظر گرفته می‌شود. (مثال: `DIN1_nnd4_Q` در جدول ۱)
3. **«جمله» (Sentence):** هر «مسیر» یا (PCP Trace) که در مرحله قبل استخراج شد، به عنوان یک «جمله» در نظر گرفته می‌شود (دنباله‌ای از کلمات).
4. **مدل Net2Vec:** حالا یک مدل پردازش زبان طبیعی (NLP) به نام **Skip-gram** (مشابه مدلی که در Word2Vec گوگل استفاده می‌شود) را روی هزاران «جمله» (مسیر) از نت‌لیست‌های سالم و آلوده به تروجان آموزش می‌دهند.
5. **خروجی (Embedding Matrix):** خروجی این مرحله یک «دیکشنری» یا «ماتریس Embedding» است.در این دیکشنری، هر «کلمه» (هر نوع اتصال گیت) یک بردار عددی (مثلاً ۱۰۰ بعدی) دارد که *معنای مفهومی* یا *نقش* آن اتصال در مدار را نشان می‌دهد.

### مرحله ۳: تشخیص با یادگیری عمیق (DL) (Steps 6-11)
1. **تبدیل جملات به بردار:** تمام «جملات» (مسیرها) با استفاده از دیکشنری مرحله قبل، به دنباله‌ای از بردارها تبدیل می‌شوند.
2. **آموزش مدل:** این دنباله‌های برداری به یک مدل یادگیری عمیق داده می‌شوند تا آموزش ببینند.
3. **مدل LSTM:** مقاله از مدل **LSTM** (حافظه طولانی کوتاه‌مدت) استفاده می‌کند، زیرا LSTMها برای درک «دنباله‌ها» (مانند جملات یا مسیرهای سیگنال) بسیار قدرتمند هستند.(مدل CNN را هم امتحان می‌کند اما LSTM بهتر عمل می‌کند).
4. **برچسب‌گذاری:** مدل آموزش می‌بیند که هر «جمله» (مسیر) را به دو کلاس «عادی» (Normal) یا «تروجان» (HT) طبقه‌بندی کند.

### مرحله ۴: رأی‌گیری نهایی (Voter) (Step 12)
1. **تشخیص:** برای تست یک نت‌لیست جدید، سیستم تمام مسیرهای (PCP Traces) آن را استخراج و با مدل DL آموزش‌دیده، طبقه‌بندی می‌کند.
2. **رأی‌گیری:** یک گیت خاص (مثلاً U3) ممکن است مرکز ۱۰۰ مسیر مختلف باشد.حالا سیستم رأی‌گیری می‌کند: اگر مثلاً ۸۰ مسیر از ۱۰۰ مسیری که از U3 عبور کرده‌اند، توسط مدل DL به عنوان «تروجان» علامت‌گذاری شوند، سیستم نتیجه می‌گیرد که خود گیت U3 بخشی از یک مدار تروجان است.
3. **دقت بالا:** این کار باعث می‌شود خطاهای تکی (False Positives) حذف شوند و دقت نهایی تشخیص بسیار بالا برود.

